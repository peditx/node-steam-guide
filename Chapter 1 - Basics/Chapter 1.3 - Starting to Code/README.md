# فصل 1.3 - شروع به نوشتن کد

پس از نصب پیش‌نیازها، می‌توانیم شروع به نوشتن کد مورد نیاز برای ورود به استیم و شبیه‌سازی کلاینت استیم کنیم. ابتدا یک فایل جدید ایجاد کنید و نام آن را `project1.js` بگذارید. داخل این فایل، کد زیر را بنویسید.

```js
const SteamUser = require('steam-user');
const client = new SteamUser();

const logOnOptions = {
  accountName: 'your_steam_username',
  password: 'your_steam_password'
};

client.logOn(logOnOptions);

client.on('loggedOn', () => {
  console.log('Logged into Steam');
});
```

حالا برنامه را با استفاده از دستور `node project1.js` اجرا کنید. اگر خطا دریافت کردید، بخش عیب‌یابی را در README اصلی بررسی کنید. اگر همه چیز درست پیش برود، از شما خواسته می‌شود که کد 2FA خود را وارد کنید (اگر 2FA را روی حساب خود تنظیم کرده‌اید)، سپس باید پیام "Logged into Steam" در خط فرمان شما ظاهر شود.

حالا بیایید کد را مرحله به مرحله بررسی کنیم.

### ماژول‌ها

در ابتدای برنامه، ما مشاهده می‌کنیم:

```js
const SteamUser = require('steam-user');
const client = new SteamUser();
```

در اینجا، ما ماژول `steam-user` که قبلاً با استفاده از NPM نصب کرده‌ایم را `require` کرده و یک نمونه جدید به نام `client` با استفاده از `new SteamUser()` ایجاد می‌کنیم. می‌توانیم متغیرهای `SteamUser` و `client` را هر چیزی که می‌خواهیم نام‌گذاری کنیم، اما معمولاً این نام‌ها را به شکل استاندارد و نزدیک به نام ماژول‌ها انتخاب می‌کنند.

### اشیاء

پس از `require` کردن ماژول‌ها و ایجاد نمونه‌ها، یک شیء جدید تعریف می‌کنیم.

```js
const logOnOptions = {
  accountName: 'your_steam_username',
  password: 'your_steam_password'
};
```

این شیء `logOnOptions` است که برای ذخیره کردن `accountName` و `password` به عنوان "کلیدها" در داخل شیء استفاده می‌شود.

### متدها

```js
client.logOn(logOnOptions);
```

ما سپس این شیء `logOnOptions` را به عنوان پارامتر به متد `logOn` از `client` که یک نمونه از `SteamUser` است، می‌دهیم. به عبارت دیگر، ما به نمونه `SteamUser` خود می‌گوییم که با استفاده از نام کاربری و رمز عبور وارد شبکه استیم شود.

یک متد به سادگی کدی است که در ماژول وجود دارد و می‌توانیم با ارجاع به نام آن از آن استفاده کنیم. در این مورد، نام متد `logOn` است. ما می‌توانیم به متد دستور بدهیم که ورودی‌هایی از ما بگیرد، این ورودی‌ها همان‌طور که در داخل پرانتزها قرار دارند، هستند.

### رویدادها

سپس یک شنونده رویداد اضافه می‌کنیم.

```js
client.on('loggedOn', () => {
  console.log('Logged into Steam');
});
```

متد `on` دو پارامتر می‌گیرد – نام رویداد و یک تابع. زمانی که `client` یک رویداد با نامی که در متد `on` مشخص کرده‌ایم ارسال کند، تابعی که ارائه کرده‌ایم اجرا خواهد شد.

وقتی `client` رویدادی به نام `loggedOn` ارسال می‌کند، ما به آن می‌گوییم که یک تابع اجرا کند که در اینجا از یک تابع پیکانی (arrow function) استفاده شده است. استفاده از تابع پیکانی یا `() => { ... }` تقریباً همانند استفاده از `function()` است، اما تفاوت‌های مهمی دارد که در زمان‌های مختلف توضیح داده خواهند شد. داخل تابع، ما به Node.js می‌گوییم که پیام "Logged into Steam" را در خط فرمان چاپ کند.

-----

عالی! ما اولین ربات استیم خود را ایجاد کردیم – اما واقعاً کار زیادی انجام نمی‌دهد. کمی ناامیدکننده است که وارد استیم شویم اما هیچ پاداشی دریافت نکنیم – حتی وضعیت خود را آنلاین نمی‌کنیم! خب، این تغییر را به راحتی می‌توانیم ایجاد کنیم. بیایید کدهایی به ربات ساده خود اضافه کنیم.

ما قصد داریم کدی به شنونده رویداد `loggedOn` اضافه کنیم تا وضعیت ربات را به آنلاین تغییر داده و شروع به بازی کردن TF2 کنیم.

```js
client.on('loggedOn', () => {
  console.log('Logged into Steam');

  client.setPersona(SteamUser.EPersonaState.Online);
  client.gamesPlayed(440);
});
```

اگر اکنون فایل را با استفاده از `node project1.js` اجرا کنیم، باید دوباره پیام "Logged into Steam" را در خط فرمان مشاهده کنیم، اما حالا اگر پروفایل استیم خود را بررسی کنیم، باید آنلاین باشیم و در حال بازی TF2 باشیم.

این دو خط تمام چیزی است که برای تغییر وضعیت ربات به آنلاین و شروع بازی TF2 نیاز داریم. متد `setPersona` می‌تواند دو پارامتر بگیرد، اولین پارامتر یک [ثابت EPersonaState](https://github.com/DoctorMcKay/node-steam-user/blob/master/enums/EPersonaState.js) است و پارامتر دوم نام شخصی است. نام شخصی لازم نیست، اما اگر بخواهید می‌توانید آن را تنظیم کنید تا نام استیم خود را تغییر دهید. به عنوان مثال، می‌توانیم از کد زیر استفاده کنیم:

```js
client.setPersona(SteamUser.EPersonaState.Online, 'andrewda');
```

تا نام استیم خود را به "andrewda" تغییر دهیم. متد `gamesPlayed` یک پارامتر می‌گیرد – شناسه اپلیکیشن یک بازی استیم یا یک رشته برای بازی غیر استیم. این متد همچنین می‌تواند برای بازی کردن در چندین بازی به طور همزمان استفاده شود، اما در این راهنما وارد جزئیات آن نمی‌شویم. توجه داشته باشید که باید بازی را داشته باشید تا بتوانید آن را بازی کنید، مگر اینکه بازی رایگان مانند TF2 باشد.

[ادامه مطلب](../Chapter%201.4%20-%20TOTP)
